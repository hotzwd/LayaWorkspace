window.wxSDKVersion,window.wxLoadVideoAd=!1;var wxGame=function(e){function n(){}function o(e,n){e=e.split("."),n=n.split(".");for(var o=Math.max(e.length,n.length);e.length<o;)e.push("0");for(;n.length<o;)n.push("0");for(var i=0;i<o;i++){var t=parseInt(e[i]),a=parseInt(n[i]);if(t>a)return 1;if(t<a)return-1}return 0}Laya.class(n,"wxGame",void 0);var i,t=n.prototype;return t.sharedCanvasTexture=null,t.shareSp=null,t.bannerAd_1=null,t.bannerAd_2=null,t.videoAd=null,t.btn_club=null,t.Init=function(){if(Browser.onMiniGame){wx.getSystemInfo({success:function(e){Gamelog("getSystemInfo SDKVersion="+e.SDKVersion),wxSDKVersion=e.SDKVersion}}),wx.showShareMenu({withShareTicket:!1});var e=this.shareInfo();wx.onShareAppMessage(function(){return{title:e[0],imageUrl:e[1]}}),wx.onShow(function(){if(MusicManager.getInstance().playMusic("res/music/1.mp3"),"function"==typeof wx.getUpdateManager){var e=wx.getUpdateManager();e.onCheckForUpdate(function(e){console.log("----更新"+e.hasUpdate)}),e.onUpdateReady(function(){e.applyUpdate()}),e.onUpdateFailed(function(){})}})}},t.login=function(e){Browser.onMiniGame&&wx.getSetting({success:function(n){var o=n.authSetting;!0===o["scope.userInfo"]?(Gamelog("用户已授权"),wxLogin(e)):!1===o["scope.userInfo"]?(Gamelog("用户已拒绝授权"),showUserInfoButton()):(Gamelog("未询问过用户授权"),wx.authorize({scope:"scope.userInfo"}))}})},wxLogin=function(e){wx.login({success:function(){Gamelog("login success"),wx.getUserInfo({success:function(n){GameLogObject(n);var o=n.userInfo;o.nickName,o.avatarUrl,o.gender,o.province,o.city,o.country;Gamelog("userInfo.nickName"+o.nickName),e(o)}})},fail:function(){Gamelog("login fail")}})},showUserInfoButton=function(){wx.createUserInfoButton({type:"text",text:"获取用户信息",image:"images/huangguan.png",style:{left:10,top:76,width:200,height:40,lineHeight:40,color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}).onTap(function(e){console.log(e)})},t.postMessage=function(e,n){Browser.onMiniGame&&n&&this.showOpenDataContext(n)},t.uploadUserScore=function(e){Browser.onMiniGame},t.showOpenDataContext=function(e){Browser.onMiniGame},t.shareInfo=function(){var e=new Array,n=3*Math.random()+1,o="";switch(n=parseInt(n,10)){case 1:o="看谁滑的远！";break;case 2:o="看我风骚的走位！";break;case 3:o="与树擦肩而过真刺激！"}var i=2*Math.random()+1;i=parseInt(i,10);var t="Game/share"+(i=1)+".png";return e.push(o),e.push(t),e},t.shareGame=function(){var e=this.shareInfo();this.share(e[0],e[1])},t.share=function(e,n){Browser.onMiniGame&&wx.shareAppMessage({title:e,imageUrl:n,success:function(e){console.log("share success",e)},fail:function(e){console.log("share fail",e)}})},t.createVideoAD=function(){if(Browser.onMiniGame){Gamelog("createVideoAD-----");var e=!1;if(wx.getSystemInfo({success:function(n){Gamelog("getSystemInfo SDKVersion="+n.SDKVersion);o(n.SDKVersion,"2.0.4")>=0&&(e=!0)}}),e){this.videoAd=wx.createRewardedVideoAd({adUnitId:"adunit-21935fac02b0497e"});var n=this.videoAd;this.videoAd.load().then(function(){Gamelog("createVideoAD load 拉取成功")}).catch(function(e){console.log("createVideoAD load 拉取失败 err.errMsg="+e.errMsg+" errCode="+e.errCode),n.load()}),this.videoAd.onError(function(e){console.log("createVideoAD 拉取失败 err.errMsg="+e.errMsg+" errCode="+e.errCode),wxLoadVideoAd=!1}),this.videoAd.onLoad(function(){console.log("createVideoAD 拉取成功 = true"),wxLoadVideoAd=!0})}}},t.showVideoAD=function(e,n){if(Browser.onMiniGame){var o=this.videoAd;null!=o&&window.wxLoadVideoAd&&(o.show(),o.onClose(function(i){o.offClose(),i&&i.isEnded||void 0===i?n.call(e,!0):n.call(e,!1)}))}else n.call(e,!0)},t.showClubBtn=function(e){if(Browser.onMiniGame){if(o(wxSDKVersion,"2.0.3")<0)return;null==this.btn_club&&(this.btn_club=wx.createGameClubButton({icon:"white",style:{left:10,top:40,width:40,height:40}})),e?this.btn_club.show():this.btn_club.hide()}},t.jumpToMiniProgram=function(e){if(Browser.onMiniGame){if(o(wxSDKVersion,"2.2.0")<0)return;Gamelog("----- jumpToMiniProgram 跳转"),wx.navigateToMiniProgram({appId:e,path:"",extraData:"",success:function(e){Gamelog("jumpToMiniProgram 跳转成功")},fail:function(e){console.log("jumpToMiniProgram fail",e)},complete:function(e){console.log("jumpToMiniProgram complete",e)}})}},{getInstance:function(){return void 0===i&&(i=new n),i}}}();